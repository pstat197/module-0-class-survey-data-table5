---
title: "Analysis of class surveys"
author: "Pratyush Rallapally, Anish Senthil, Satvik Talchuru, Andrew Guerra, Akhil Gorla"
date: last-modified
published-title: "Updated"
editor: visual
format: html
code-copy: true
execute:
  message: false
  warning: false
  echo: false
  cache: true
---

```{r}
# load any other packages and read data here
library(tidyverse)
library(dplyr)
library(readr)
library(here)
url <- "https://raw.githubusercontent.com/pstat197/module-0-class-survey-data-table5/main/data/"

# load datasets
background <- read_csv(paste0(url, "background-clean.csv"))
df <- read_csv(here("data", "background-clean.csv"))

# Convert proficiency to numeric 
df <- df %>%
  mutate(
    prog.prof.num = case_when(
      prog.prof == "beg" ~ 1,
      prog.prof == "int" ~ 2,
      prog.prof == "adv" ~ 3
    ),
    math.prof.num = case_when(
      math.prof == "beg" ~ 1,
      math.prof == "int" ~ 2,
      math.prof == "adv" ~ 3
    ),
    stat.prof.num = case_when(
      stat.prof == "beg" ~ 1,
      stat.prof == "int" ~ 2,
      stat.prof == "adv" ~ 3
    )
  )

```

## Executive summary

We analyzed survey data from PSTAT197A students to examine how self-rated proficiency in programming, mathematics, and statistics relates to comfort in each domain. Linear regression and correlation analyses revealed strong positive relationships within each area, especially in statistics, with programming and mathematics showing moderate but similar trends. Cross-domain correlations were weak, suggesting confidence does not easily transfer across areas. Overall, we found that students feel generally most comfortable where they perceive higher proficiency, highlighting opportunities to strengthen cross-disciplinary integration.

## Data description

This dataset contains survey responses from UCSB undergraduate students enrolled in PSTAT197A, collected to capture their academic background, skills, and project interests. The survey collected personal information alongside self-reported proficiency and comfort in programming, mathematics, and statistics. Additional background measures include the number of upper-division courses completed, domain specialization, and prior research experience in data science and other areas.

The survey also recorded students’ project preferences, including preferred project type (industry vs. lab), programming language, domain, and data science areas of interest, as well as open-ended goals and comments for project placement. Several variables are binary (yes/no), ordinal, numeric, or categorical.

Overall, the dataset provides a detailed profile of students’ academic preparation, skill self-assessment, and project preferences, suitable for analyzing patterns in preparation, interests, and experiences among the PSTAT197A cohort. For our purposes, we believe the data provides a valuable snapshot of PSTAT majors, particularly those most motivated and engaged. While the survey cohort is naturally self-selected, this bias makes the data especially informative: it highlights where the department’s most engaged feel well-prepared or identify gaps in their skills. Understanding these patterns is crucial, as it allows the department to identify strengths and potential areas for curricular improvement.

## Questions of interest

2.  *How does students' reported proficiency relate to the amount of upper division courses taken?*

<!-- -->

3.  *To what extent do students’ self-assessed proficiency in programming, mathematics, and statistics align with their reported comfort in these domains?*

## Findings

To answer our question, we first observe the characteristics of both the 'updv.num' and 'stat.prof' variables. The 'updv.num' variable is an ordinal categorical variable that separates courses taken in the following way.

```{r}
unique(background$updv.num) %>% knitr::kable()
unique(background$stat.prof) %>%  knitr::kable()
```

Furthermore, our 'stat.prof' variable is a self-reported measure of the student's perceived confidence regarding their statistics skills.

Next, we created a summary table to help capture the distribution of students among both course range and frequency. Using survey data, we calculated the frequency in selection of upper-division courses among different proficiency ratings.

```{r}
survey_sum <- background %>% 
  count(stat.prof, updv.num) %>% 
  group_by(stat.prof) %>% 
  mutate(prop = n / sum(n)) %>% 
  arrange(stat.prof, desc(prop))

survey_sum %>% 
  knitr::kable(caption = "Class Survey Summary Table (updv.num and stat.prof)",
               digits = 2)
```

Based on our table, we find that 33 students reported an advanced level of statistics proficiency, followed by 15 reporting intermediate and 3 at beginner proficiency. While both intermediate and advanced proficiencies consisted of students who have taken more than 9 upper-division PSTAT courses, no student that has taken 9 or more courses reported their proficiency as beginner. Notably, we find that two-thirds of students with an advanced proficiency (n=22) have taken 9 or more upper-division courses. Among intermediate students, one-third (n=5) report taking 9 or more upper-division courses. At a high level, it appears that a student's reported proficiency in statistics is positively correlated with the number of upper-division courses they have taken.

To better visualize this trend, we created a bar-plot for each reported proficiency.

```{r}
background <- background %>% 
  mutate(
    stat.prof = factor(stat.prof, levels = c("beg", "int", "adv"))
  )

background %>% 
  ggplot(mapping = aes(x = updv.num)) + 
  facet_wrap(~ stat.prof) +
  geom_bar(fill = "blue3", color='white') +
  labs(
    title = "Upper-Division PSTAT Courses by Reported Proficiency",
    x = "Upper-Division Courses Taken",
    y = "Number of Students"
  ) +
  theme_minimal()
```

Based on our bar-plot, we see a clear upward trend between students' reproted proficinecy in statistics and the number of upper-division PSTAT courses completed. Among students with beginner proficiency, course completion is concentrated in the 0-2 and 6-8 ranges, with no beginner student taking 9 or more. Intermediate students show a slightly more even distribution, however, with most having taken 6-8 courses, followed by 9 or more and 3-5 but none taking 0-2 courses. In contrast, the advanced group displays the most pronounced pattern, with most students having completed 9 or moure upper-division courses, with fewer having taken 6-8 or 3-5 courses. Overall, we see a clear trend that students' confidence in their statistics proficiency increases with more upper-division coursework.

For an objective analysis, we ran a Chi-Square test of Independence to examine the relationship between students' reported statistics proficiency and the number of upper-division PSTAT courses completed.

```{r}
table(background$stat.prof, background$updv.num) %>% 
  chisq.test()
```

The test indicated a significant association between the two variables ($\chi^2 = 39.109, df = 6, p = 6.814e-07$). This supports the visual trend observed in the bar-plot, where students with higher proficiency levels tended to have completed more upper-division coursework.

We analyzed the relationship between students’ self-assessed proficiency and comfort in programming, mathematics, and statistics using the survey data. Proficiency responses were converted from categorical to numeric values in order to run a numerical analysis, and for each domain, we fitted a simple linear regression model predicting comfort from proficiency. The results are summarized below:

```{r}
lm_prog <- lm(prog.comf ~ prog.prof.num, data = df)
lm_math <- lm(math.comf ~ math.prof.num, data = df)
lm_stat <- lm(stat.comf ~ stat.prof.num, data = df)

# clean result
lm_results <- tibble(
  domain = c("Programming", "Mathematics", "Statistics"),
  intercept = c(coef(lm_prog)[1], coef(lm_math)[1], coef(lm_stat)[1]),
  slope = c(coef(lm_prog)[2], coef(lm_math)[2], coef(lm_stat)[2]),
  r_squared = c(summary(lm_prog)$r.squared,
                summary(lm_math)$r.squared,
                summary(lm_stat)$r.squared)
)

(lm_results)
```

In general, across all three domains, higher self-rated proficiency is associated with higher reported comfort. This expected relationship is the strongest in statistics, at almost twice the extent compared to programming and mathematics, who had nearly identical moderate associations.

We further explored these relationships through other visualizations, including scatterplots and a correlation heatmap.

```{r}
plot_data <- bind_rows(
  df %>% select(prof = prog.prof.num, comf = prog.comf) %>% mutate(domain = "Programming"),
  df %>% select(prof = math.prof.num, comf = math.comf) %>% mutate(domain = "Mathematics"),
  df %>% select(prof = stat.prof.num, comf = stat.comf) %>% mutate(domain = "Statistics")
)

ggplot(plot_data, aes(x = prof, y = comf)) +
  geom_jitter(width = 0.2, height = 0.2, alpha = 0.6, color = "darkblue") +
  geom_smooth(method = "lm", se = TRUE, color = "steelblue") +
  facet_wrap(~ domain, scales = "free") +
  labs(
    x = "Self-rated Proficiency (1=beg, 2=int, 3=adv)",
    y = "Comfort Level (1-5)",
    title = "Linear Regression of Comfort on Proficiency by Domain"
  ) +
  theme_minimal()
```

In addition to seeing how the original data is clustered, the plots visually reaffirm our conclusions; within the same domain, students generally feel more confident the more proficient they are.

Thus far, the analysis has been domain-specific. To explore correlations across domains, we generated a correlation matrix, visualized in the form of a heatmap below:

```{r}
# cor matrix
prof_vars <- df %>% select(prog.prof.num, math.prof.num, stat.prof.num)
comf_vars <- df %>% select(prog.comf, math.comf, stat.comf)

# compute correlations
cor_matrix <- cor(prof_vars, comf_vars, use = "complete.obs")

# convert to long format for ggplot
cor_long <- as.data.frame(cor_matrix) %>%
  rownames_to_column(var = "Proficiency") %>%
  pivot_longer(
    cols = -Proficiency,
    names_to = "Comfort",
    values_to = "Correlation"
  )


ggplot(cor_long, aes(x = Comfort, y = Proficiency, fill = Correlation)) +
  geom_tile(color = "white") +
  geom_text(aes(label = round(Correlation, 2)), color = "black", size = 5) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,
                       limits = c(-1, 1)) +
  labs(
    title = "Correlation Between Proficiency and Comfort by Domain",
    x = "Comfort",
    y = "Proficiency"
  ) +
  theme_minimal(base_size = 14) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) #experimenting with dimensional variables
```

From here, we see some interesting relations. Across the diagonal, we see the same earlier trend of higher proficiency equating higher comfort when aligned in the same domain. However, cross-domain correlations are weaker, suggesting that proficiency in one area does not strongly predict comfort in another. Most notably, there appears to be no relationship whatsoever between math and programming. This pattern highlights that students’ perceived abilities are largely within the same domain, with comfort most closely tracking proficiency in the same area, particularly for statistics. The weaker cross-domain associations also suggest potential gaps in transferable confidence, indicating that even students who feel capable in one technical area may not feel equally comfortable applying those skills elsewhere. The relatively weaker associations highlight gaps where even motivated students may feel less confident relative to their proficiency, necessitating possible changes for curriculum planning and targeted support.
